{% xlsdocument %}
    {% xlssheet 'hoja1' {
        columnDimension: {
            'A': {
                autoSize: true,
            },
            'I': {
                autoSize: true,
            }
        },
        pageMargins: {
            top: 1,
            bottom: 1,
            left: 0.75,
            right: 0.75,
            header: 0.5,
            footer: 0.5
        },
        pageSetup: {
            fitToHeight: 0,
            fitToPage: true,
            fitToWidth: 1,
            horizontalCentered: false,
            orientation: 'portrait',
            paperSize: 9,
            scale: 100,
            verticalCentered: false
        },
        printGridlines: true,
        rightToLeft: false,
        rowDimension: {
            'default': {
                collapsed: false,
                outlineLevel: 0,
                rowHeight: -1,
                rowIndex: '1',
                visible: true,
                xfIndex: 0,
                zeroHeight: false
            }
        },
        sheetState: 'visible',
        showGridlines: true,
        tabColor: 'FF0000',
        zoomScale: 100
    } %}
        {# HEADER #}
        {% xlsrow 1 %}
            {% xlscell {
                merge: 9,
                style: {
                    alignment: {
                        horizontal: 'left',
                        vertical: 'center'
                    },
                    font: {
                        size: 18
                    }
                }
            } %}{{ 'pdf.damage_table_header.9_excel_title' | trans({'%name%': windfarm.name | upper}, 'messages', locale) }} {{ year }}{% endxlscell %}
        {% endxlsrow %}
        {% xlsrow 2 %}
            {% xlscell 1 {
                merge: 'A3',
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}WTG{% endxlscell %}
            {% xlscell 2 {
                merge: 'B3',
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{{ 'pdf.damage_table_header.10_blade' | trans({}, 'messages', locale) }}{% endxlscell %}
            {% xlscell 3 {
                merge: 'D2',
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{{ 'pdf.damage_table_header.1_damage' | trans({}, 'messages', locale) }}{% endxlscell %}
            {% xlscell 4 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{% endxlscell %}
            {% xlscell 5 {
                merge: 'G2',
                style: {
                    borders: {
                        top: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{{ 'pdf.damage_table_header.2_position' | trans({}, 'messages', locale) }}{% endxlscell %}
            {% xlscell 6 {
                style: {
                    borders: {
                        top: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{% endxlscell %}
            {% xlscell 7 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{% endxlscell %}
            {% xlscell 8 {
                merge: 'H3',
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{{ 'pdf.damage_table_header.6_size' | trans({}, 'messages', locale) }}{% endxlscell %}
            {% xlscell 9 {
                merge: 'I3',
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{{ 'pdf.damage_table_header.7_description' | trans({}, 'messages', locale) }}{% endxlscell %}
            {% xlscell 10 {
                merge: 'J3',
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}CAT{% endxlscell %}
        {% endxlsrow %}
        {% xlsrow 3 %}
            {% xlscell 1 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{% endxlscell %}
            {% xlscell 2 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{% endxlscell %}
            {% xlscell 3 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{{ 'pdf.damage_table_header.3_number' | trans({}, 'messages', locale) }}{% endxlscell %}
            {% xlscell 4 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{{ 'pdf.damage_table_header.4_code' | trans({}, 'messages', locale) }}{% endxlscell %}
            {% xlscell 5 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}Pos.{% endxlscell %}
            {% xlscell 6 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{{ 'pdf.damage_table_header.5_radius' | trans({}, 'messages', locale) }}{% endxlscell %}
            {% xlscell 7 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    alignment: {
                        horizontal: 'center',
                        vertical: 'center'
                    },
                    font: {
                        size: '12',
                        bold: true
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}Dist.{% endxlscell %}
            {% xlscell 8 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{% endxlscell %}
            {% xlscell 9 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{% endxlscell %}
            {% xlscell 10 {
                style: {
                    borders: {
                        allborders: {
                            style: 'thin',
                            color: {
                                rgb: '8FABD9'
                            }
                        }
                    },
                    fill: {
                        type: 'solid',
                        color: {
                            rgb: 'D9E2F2'
                        }
                    }
                }
            } %}{% endxlscell %}
        {% endxlsrow %}
        {# BODY #}
        {% for audit in audits %}
            {% for auditWindmillBlade in audit.auditWindmillBlades %}
                {% for bladeDamage in auditWindmillBlade.bladeDamages if is_row_available(bladeDamage.damageCategory, damage_categories) %}
                    {% xlsrow %}
                        {% xlscell 1 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ audit.windmill.code }}{% endxlscell %}
                        {% xlscell 2 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ auditWindmillBlade.windmillBlade.order }}{% endxlscell %}
                        {% xlscell 3 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ loop.index }}{% endxlscell %}
                        {% xlscell 4 {
                            dataType: 's',
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ bladeDamage.damage.code }}{% endxlscell %}
                        {% xlscell 5 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ bladeDamage.positionStringLocalized | trans({}, 'messages', locale) }}{% endxlscell %}
                        {% xlscell 6 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ bladeDamage.radius }} m{% endxlscell %}
                        {% xlscell 7 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ bladeDamage.localizedDistanceString | trans({'%dist%': bladeDamage.distanceScaled}, 'messages', locale) }}{% endxlscell %}
                        {% xlscell 8 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ bladeDamage.size }} cm{% endxlscell %}
                        {% xlscell 9 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                }
                            }
                        } %}{{ get_localized_description(bladeDamage.damage, locale) }}{% endxlscell %}
                        {% xlscell 10 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                },
                                fill: {
                                    type: 'solid',
                                    color: {
                                        rgb: bladeDamage.damageCategory.colourWithoutPad
                                    }
                                }
                            }
                        } %}{{ bladeDamage.damageCategory.category }}{% endxlscell %}
                    {% endxlsrow %}
                {% else %}
                    {% xlsrow %}
                        {% xlscell 1 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ audit.windmill.code }}{% endxlscell %}
                        {% xlscell 2 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}{{ auditWindmillBlade.windmillBlade.order }}{% endxlscell %}
                        {% xlscell 3 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}-{% endxlscell %}
                        {% xlscell 4 {
                            dataType: 's',
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        }%}0.00{% endxlscell %}
                        {% xlscell 5 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}-{% endxlscell %}
                        {% xlscell 6 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}-{% endxlscell %}
                        {% xlscell 7 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}-{% endxlscell %}
                        {% xlscell 8 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                }
                            }
                        } %}-{% endxlscell %}
                        {% xlscell 9 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                }
                            }
                        } %}{{ 'pdf.damage_table_body.no_damages_found' | trans({}, 'messages', locale) }}{% endxlscell %}
                        {% xlscell 10 {
                            style: {
                                borders: {
                                    allborders: {
                                        style: 'thin',
                                        color: {
                                            rgb: '8FABD9'
                                        }
                                    }
                                },
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                },
                                fill: {
                                    type: 'solid',
                                    color: {
                                        rgb: 'FFFFFF'
                                    }
                                }
                            }
                        } %}0{% endxlscell %}
                    {% endxlsrow %}
                {% endfor %}
            {% endfor %}
        {% endfor %}
    {% endxlssheet %}
{% endxlsdocument %}
